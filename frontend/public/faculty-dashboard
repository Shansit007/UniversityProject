<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Faculty Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-r from-blue-50 to-indigo-100 font-sans min-h-screen flex items-center justify-center">

  <div class="bg-white shadow-2xl rounded-2xl p-8 w-full max-w-2xl">
    <h1 class="text-3xl font-bold text-center mb-6 text-indigo-700">Setup Your Dashboard</h1>

    <form id="dashboardForm" class="space-y-6">

      <!-- Cabin -->
      <div class="bg-indigo-50 p-4 rounded-xl shadow-sm">
        <label class="block text-lg font-semibold text-gray-700 mb-2">üè¢ Cabin Number</label>
        <input type="text" id="cabin" placeholder="Enter your cabin number"
               class="border border-gray-300 p-3 w-full rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
      </div>

      <!-- Free Slots -->
      <div class="bg-indigo-50 p-4 rounded-xl shadow-sm">
        <label class="block text-lg font-semibold text-gray-700 mb-4">üïí Select Your Free Slots</label>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">

          <!-- Example Slot Card -->
          <label class="flex items-center justify-between bg-white rounded-xl px-4 py-3 shadow hover:shadow-md transition cursor-pointer">
            <span class="text-gray-700">8:30 - 10:00</span>
            <input type="checkbox" value="8.30-10.00" class="toggle-slot hidden">
            <span class="toggle-btn w-12 h-6 bg-gray-300 rounded-full relative transition">
              <span class="dot absolute left-1 top-1 w-4 h-4 bg-white rounded-full shadow transition"></span>
            </span>
          </label>

          <label class="flex items-center justify-between bg-white rounded-xl px-4 py-3 shadow hover:shadow-md transition cursor-pointer">
            <span class="text-gray-700">10:00 - 11:40</span>
            <input type="checkbox" value="10.00-11.40" class="toggle-slot hidden">
            <span class="toggle-btn w-12 h-6 bg-gray-300 rounded-full relative transition">
              <span class="dot absolute left-1 top-1 w-4 h-4 bg-white rounded-full shadow transition"></span>
            </span>
          </label>

          <label class="flex items-center justify-between bg-white rounded-xl px-4 py-3 shadow hover:shadow-md transition cursor-pointer">
            <span class="text-gray-700">11:40 - 1:15</span>
            <input type="checkbox" value="11.40-1.15" class="toggle-slot hidden">
            <span class="toggle-btn w-12 h-6 bg-gray-300 rounded-full relative transition">
              <span class="dot absolute left-1 top-1 w-4 h-4 bg-white rounded-full shadow transition"></span>
            </span>
          </label>

          <label class="flex items-center justify-between bg-white rounded-xl px-4 py-3 shadow hover:shadow-md transition cursor-pointer">
            <span class="text-gray-700">1:15 - 2:50</span>
            <input type="checkbox" value="1.15-2.50" class="toggle-slot hidden">
            <span class="toggle-btn w-12 h-6 bg-gray-300 rounded-full relative transition">
              <span class="dot absolute left-1 top-1 w-4 h-4 bg-white rounded-full shadow transition"></span>
            </span>
          </label>

          <label class="flex items-center justify-between bg-white rounded-xl px-4 py-3 shadow hover:shadow-md transition cursor-pointer">
            <span class="text-gray-700">2:50 - 4:20</span>
            <input type="checkbox" value="2.50-4.20" class="toggle-slot hidden">
            <span class="toggle-btn w-12 h-6 bg-gray-300 rounded-full relative transition">
              <span class="dot absolute left-1 top-1 w-4 h-4 bg-white rounded-full shadow transition"></span>
            </span>
          </label>

          <label class="flex items-center justify-between bg-white rounded-xl px-4 py-3 shadow hover:shadow-md transition cursor-pointer">
            <span class="text-gray-700">4:20 - 6:00</span>
            <input type="checkbox" value="4.20-6.00" class="toggle-slot hidden">
            <span class="toggle-btn w-12 h-6 bg-gray-300 rounded-full relative transition">
              <span class="dot absolute left-1 top-1 w-4 h-4 bg-white rounded-full shadow transition"></span>
            </span>
          </label>

          <label class="flex items-center justify-between bg-white rounded-xl px-4 py-3 shadow hover:shadow-md transition cursor-pointer">
            <span class="text-gray-700">6:00 - 7:30</span>
            <input type="checkbox" value="6.00-7.30" class="toggle-slot hidden">
            <span class="toggle-btn w-12 h-6 bg-gray-300 rounded-full relative transition">
              <span class="dot absolute left-1 top-1 w-4 h-4 bg-white rounded-full shadow transition"></span>
            </span>
          </label>

        </div>
      </div>

      <!-- Note -->
      <div class="bg-indigo-50 p-4 rounded-xl shadow-sm">
        <label class="block text-lg font-semibold text-gray-700 mb-2">üìù Optional Note</label>
        <textarea id="note" rows="3" placeholder="e.g., don't come on Thursdays"
                  class="border border-gray-300 p-3 w-full rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"></textarea>
      </div>

      <!-- Submit -->
      <button type="submit"
              class="w-full py-3 rounded-xl bg-indigo-600 text-white font-semibold text-lg hover:bg-indigo-700 shadow-md transition">
        üöÄ Save Dashboard
      </button>
    </form>
  </div>

  <script>
    // Toggle Switch Animation
    document.querySelectorAll('.toggle-slot').forEach(input => {
      const toggleBtn = input.nextElementSibling;
      const dot = toggleBtn.querySelector('.dot');

      toggleBtn.addEventListener('click', () => {
        input.checked = !input.checked;
        if (input.checked) {
          toggleBtn.classList.remove('bg-gray-300');
          toggleBtn.classList.add('bg-green-500');
          dot.classList.add('translate-x-6');
        } else {
          toggleBtn.classList.remove('bg-green-500');
          toggleBtn.classList.add('bg-gray-300');
          dot.classList.remove('translate-x-6');
        }
      });
    });

    // Submit Handler
    const facultyToken = localStorage.getItem('facultyToken');

    document.getElementById('dashboardForm').addEventListener('submit', async e => {
      e.preventDefault();

      const cabin = document.getElementById('cabin').value;
      const note = document.getElementById('note').value;
      const freeSlots = Array.from(document.querySelectorAll('.toggle-slot:checked')).map(i => i.value);

      if (!cabin) return alert('Please enter your cabin number');

      try {
        const res = await fetch('http://localhost:5000/api/faculty/setup', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${facultyToken}`
          },
          body: JSON.stringify({ cabin, freeSlots, note })
        });

        const data = await res.json();
        if (res.ok) {
          alert('‚úÖ Dashboard setup complete!');
          console.log('Faculty data:', data);
        } else {
          alert('‚ùå ' + data.msg);
        }
      } catch (err) {
        console.error(err);
        alert('‚ö†Ô∏è Server error. Try again.');
      }
    });
  </script>

</body>
</html>
